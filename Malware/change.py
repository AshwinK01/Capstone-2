import pandas as pd

# Load the CSV file
file_path = r"C:\Users\ashwi\Downloads\data_file.csv"  # Update this to the correct file path
data = pd.read_csv(file_path)

# Define the rules to classify MalwareType
def classify_malware(row):
    if row.get('BitcoinAddresses', 0) > 0:
        return 'Ransomware'
    elif isinstance(row.get('DllCharacteristics'), str) and '0x0040' in row['DllCharacteristics']:
        return 'Rootkit'
    elif row.get('ResourceSize', 0) > 10 * 1024 * 1024:  # ResourceSize > 10 MB
        return 'Trojan'
    elif row.get('DebugSize', 0) > row.get('NormalRange', 0):  # DebugSize > NormalRange
        return 'Obfuscated'
    else:
        return 'Unknown'

# Apply the classification rules to each row
data['MalwareType'] = data.apply(classify_malware, axis=1)

# Save the updated data to a new CSV file
output_path = r"C:\Users\ashwi\Downloads\data_file(1).csv"
data.to_csv(output_path, index=False)

print(f"Updated file with 'MalwareType' column saved to {output_path}")
